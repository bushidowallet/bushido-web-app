function getEnv(){return"localhost"==window.location.hostname?"dev":"prod"}var app=angular.module("app",["ngCookies"]);app.config(function(t){t.defaults.path="/"}),function(t){t.QueryString=function(t){if(""===t)return{};for(var e={},n=0;n<t.length;++n){var c=t[n].split("=");2==c.length&&(e[c[0]]=decodeURIComponent(c[1].replace(/\+/g," ")))}return e}(window.location.search.substr(1).split("&"))}(jQuery),app.factory("appConfig",function(){var t=function(){this.defaultRecipientAddress="1KxRfiqcNi2GbpdN3pzuQHgewShmeNW9g1",this.dotPayUrlBase="https://ssl.dotpay.pl/t2/?id=447185"};return t.prototype.init=function(t){return this.env=t,this.urlBase="prod"==t?"https://api.bushidowallet.com/walletapi":"http://localhost:8080/walletapi",this.socketServerUrl="prod"==t?"https://websockets.bushidowallet.com/stomp":"http://localhost:15674/stomp",console.log("Initialized AppConfig for environment "+t),this},new t}),app.factory("walletModel",function(){var t=function(){};return t.prototype.init=function(t,e,n,c){this.user=t,this.wallets=e,this.selectedWallet=n?n:e[0];for(var a,o=c?c.account:this.selectedWallet.accounts[0].account,l=0;l<this.selectedWallet.accounts.length;l++)this.selectedWallet.accounts[l].account==o&&(a=this.selectedWallet.accounts[l]);return a?this.selectedAccount=a:console.log("Unable to find account "+o+" on wallet "+this.selectedWallet.key),this},new t}),app.factory("walletManager",function(){var t,e,n=function(){e.put("user",t.user),e.put("wallets",t.wallets),e.put("selectedWallet",t.selectedWallet),e.put("selectedAccount",t.selectedAccount)};return{init:function(c,a,o,l){var r=l.init(c.get("user"),c.get("wallets"),c.get("selectedWallet"),c.get("selectedAccount")),s=o.init(getEnv());a.model=r,a.config=s,t=r,e=c,n()},open:function(e){t.selectedWallet=e,t.selectedAccount=e.accounts[0],n()},save:function(){n()},update:function(e){for(var c=0;c<t.wallets.length;c++)t.wallets[c].key==e.key&&t.wallets.slice(c,1,e);t.selectedWallet.key==e.key&&(t.selectedWallet=e);for(var a=0;a<e.accounts.length;a++)t.selectedAccount.account==e.accounts[a].account&&(t.selectedAccount=e.accounts[a]);n()}}}),app.factory("Base64",function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e){var n,c,a,o,l,r="",s="",i="",u=0;do n=e.charCodeAt(u++),c=e.charCodeAt(u++),s=e.charCodeAt(u++),a=n>>2,o=(3&n)<<4|c>>4,l=(15&c)<<2|s>>6,i=63&s,isNaN(c)?l=i=64:isNaN(s)&&(i=64),r=r+t.charAt(a)+t.charAt(o)+t.charAt(l)+t.charAt(i),n=c=s="",a=o=l=i="";while(u<e.length);return r},decode:function(e){var n,c,a,o,l,r="",s="",i="",u=0,d=/[^A-Za-z0-9\+\/\=]/g;d.exec(e)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do a=t.indexOf(e.charAt(u++)),o=t.indexOf(e.charAt(u++)),l=t.indexOf(e.charAt(u++)),i=t.indexOf(e.charAt(u++)),n=a<<2|o>>4,c=(15&o)<<4|l>>2,s=(3&l)<<6|i,r+=String.fromCharCode(n),64!=l&&(r+=String.fromCharCode(c)),64!=i&&(r+=String.fromCharCode(s)),n=c=s="",a=o=l=i="";while(u<e.length);return r}}});