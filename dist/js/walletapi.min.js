var WalletApi;!function(){function e(e,s,i,n,o,r,a,c,l,h){h||(h=t()),r&&a.push(new MessageListener(h,n,r,"rpc")),console.log("Invoking "+n+" on wallet "+c+" with correlationId: "+h+"..."),e.send(l,{"content-type":"application/json",__TypeId__:"com.bitcoin.blockchain.api.domain.message.ClientMessage"},JSON.stringify({correlationId:h,username:s,password:i,key:c,command:n,payload:o}))}function t(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?s:3&s|8).toString(16)});return t}WalletApi=function(t,s,i,n,o,r,a,c,l,h,p){var d=new SockJS(t),v=Stomp.over(d);v.heartbeat.incoming=0,v.heartbeat.outgoing=0;var u=[];return this.client=v,this.serviceUser="bushido",this.servicePassword="bushido",this.username=s,this.password=i,this.walletId=n,this.sendDestination=h,this.observers=u,this.on_connect=function(){p&&p.call(this),v.subscribe(l+n),r&&e(v,s,i,r,a,c,u,n,h)},this.on_error=function(){console.log("error")},v.onreceive=function(e){var t=JSON.parse(e.body),s=-1;if(u){for(var i=0;i<u.length;i++)"notification"==u[i].type?u[i].command==t.command&&u[i].handler.call(this,t):"rpc"==u[i].type&&u[i].correlationId==t.correlationId&&(s=i,u[i].handler.call(this,t));s>-1&&u.splice(s,1)}},o&&this.connect(),{connect:WalletApi.prototype.connect,invoke:WalletApi.prototype.invoke,addListener:WalletApi.prototype.addListener,removeListener:WalletApi.prototype.removeListener,observers:this.observers,client:this.client,serviceUser:this.serviceUser,servicePassword:this.servicePassword,on_connect:this.on_connect,on_error:this.on_error,username:this.username,password:this.password,walletId:this.walletId,sendDestination:this.sendDestination}},WalletApi.prototype.connect=function(){return this.client.connect(this.serviceUser,this.servicePassword,this.on_connect,this.on_error,"/"),this},WalletApi.prototype.invoke=function(t,s,i,n){return e(this.client,this.username,this.password,t,s,i,this.observers,this.walletId,this.sendDestination,n),this},WalletApi.prototype.addListener=function(e,t){return this.observers.push(new MessageListener(null,e,t,"notification")),this},WalletApi.prototype.removeListener=function(e,t){for(var s=-1,i=0;i<this.observers.length;i++)this.observers[i].command==e&&this.observers[i].handler==t&&"notification"==this.observers[i].type&&(s=i);return s>-1&&this.observers.splice(s,1),this}}();var MessageListener=function(e,t,s,i){this.correlationId=e,this.command=t,this.handler=s,this.type=i};