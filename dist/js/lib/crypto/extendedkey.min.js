var ExtendedKey;!function(){ExtendedKey=function(e,t){if(e){var i=Util.hexToBytes(e.slice(0,64)),s=Util.hexToBytes(e.slice(64,128)),n=new ECKey(i);n.pub=n.getPubPoint(),n.setCompressed(t),n.pubKeyHash=Util.sha256ripe160(n.pub.getEncoded(t)),this.ecKey=n,this.chainCode=s,this.parentFingerprint=Util.hexToBytes("00000000"),this.version=76066276,this.depth=0,this.childIndex=0}return{getPrivateKey:this.getPrivateKey,serializePrivate:this.serializePrivate,getWif:this.getWif,derive:this.derive,version:this.version,depth:this.depth,parentFingerprint:this.parentFingerprint,childIndex:this.childIndex,chainCode:this.chainCode,ecKey:this.ecKey}},ExtendedKey.prototype.getPrivateKey=function(){var e=[],t=this.version;e.push(t>>24),e.push(t>>16&255),e.push(t>>8&255),e.push(255&t),e.push(this.depth),e=e.concat(this.parentFingerprint),e.push(this.childIndex>>>24),e.push(this.childIndex>>>16&255),e.push(this.childIndex>>>8&255),e.push(255&this.childIndex),e=e.concat(this.chainCode),e.push(0);for(var i=this.ecKey.priv.toByteArrayUnsigned();i.length<32;)i.unshift(0);return e=e.concat(i)},ExtendedKey.prototype.serializePrivate=function(e){var t=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0}),i=t.slice(0,4),s=e.concat(i);return Base58.encode(s)},ExtendedKey.prototype.derive=function(e){var t=[];t.push(e>>24&255),t.push(e>>16&255),t.push(e>>8&255),t.push(255&e);var i=getSECCurveByName("secp256k1"),s=this.ecKey.pub.getEncoded(this.ecKey.compressed).concat(t),n=new jsSHA(Crypto.util.bytesToHex(s),"HEX"),r=n.getHMAC(Crypto.util.bytesToHex(this.chainCode),"HEX","SHA-512","HEX"),h=new BigInteger(r.slice(0,64),16),c=Crypto.util.hexToBytes(r.slice(64,128)),o=h.add(this.ecKey.priv).mod(i.getN()),d=new ExtendedKey;return d.chainCode=c,d.ecKey=new ECKey(o.toByteArrayUnsigned()),d.ecKey.pub=d.ecKey.getPubPoint(),d.childIndex=e,d.parentFingerprint=this.ecKey.pubKeyHash.slice(0,4),d.version=this.version,d.depth=this.depth+1,d.ecKey.setCompressed(this.ecKey.compressed),d.ecKey.pubKeyHash=Util.sha256ripe160(d.ecKey.pub.getEncoded(this.ecKey.compressed)),d},ExtendedKey.prototype.getWif=function(){var e;e=this.ecKey.compressed===!0?[128].concat(this.ecKey.priv.toByteArrayUnsigned()).concat([1]):[128].concat(this.ecKey.priv.toByteArrayUnsigned());var t=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0}).slice(0,4);return Base58.encode(e.concat(t))}}();