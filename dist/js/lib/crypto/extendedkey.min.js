var ExtendedKey;!function(){ExtendedKey=function(keyHash,compressed){if(keyHash){var l=Util.hexToBytes(keyHash.slice(0,64)),r=Util.hexToBytes(keyHash.slice(64,128)),ecKey=new ECKey(l);ecKey.pub=ecKey.getPubPoint(),ecKey.setCompressed(compressed),ecKey.pubKeyHash=Util.sha256ripe160(ecKey.pub.getEncoded(compressed)),this.ecKey=ecKey,this.chainCode=r,this.parentFingerprint=Util.hexToBytes("00000000"),this.version=76066276,this.depth=0,this.childIndex=0}return{getPrivateKey:this.getPrivateKey,serializePrivate:this.serializePrivate,getWif:this.getWif,derive:this.derive,version:this.version,depth:this.depth,parentFingerprint:this.parentFingerprint,childIndex:this.childIndex,chainCode:this.chainCode,ecKey:this.ecKey}},ExtendedKey.prototype.getPrivateKey=function(){var p=[],v=this.version;p.push(v>>24),p.push(v>>16&255),p.push(v>>8&255),p.push(255&v),p.push(this.depth),p=p.concat(this.parentFingerprint),p.push(this.childIndex>>>24),p.push(this.childIndex>>>16&255),p.push(this.childIndex>>>8&255),p.push(255&this.childIndex),p=p.concat(this.chainCode),p.push(0);for(var k=this.ecKey.priv.toByteArrayUnsigned();k.length<32;)k.unshift(0);return p=p.concat(k)},ExtendedKey.prototype.serializePrivate=function(keyBytes){var hash=Crypto.SHA256(Crypto.SHA256(keyBytes,{asBytes:!0}),{asBytes:!0}),checksum=hash.slice(0,4),data=keyBytes.concat(checksum);return Base58.encode(data)},ExtendedKey.prototype.derive=function(i){var ib=[];ib.push(i>>24&255),ib.push(i>>16&255),ib.push(i>>8&255),ib.push(255&i);var ecparams=getSECCurveByName("secp256k1"),data=this.ecKey.pub.getEncoded(this.ecKey.compressed).concat(ib),j=new jsSHA(Crypto.util.bytesToHex(data),"HEX"),hash=j.getHMAC(Crypto.util.bytesToHex(this.chainCode),"HEX","SHA-512","HEX"),l=new BigInteger(hash.slice(0,64),16),r=Crypto.util.hexToBytes(hash.slice(64,128)),k=l.add(this.ecKey.priv).mod(ecparams.getN()),child=new ExtendedKey;return child.chainCode=r,child.ecKey=new ECKey(k.toByteArrayUnsigned()),child.ecKey.pub=child.ecKey.getPubPoint(),child.childIndex=i,child.parentFingerprint=this.ecKey.pubKeyHash.slice(0,4),child.version=this.version,child.depth=this.depth+1,child.ecKey.setCompressed(this.ecKey.compressed),child.ecKey.pubKeyHash=Util.sha256ripe160(child.ecKey.pub.getEncoded(this.ecKey.compressed)),child},ExtendedKey.prototype.getWif=function(){var bytes;bytes=this.ecKey.compressed===!0?[128].concat(this.ecKey.priv.toByteArrayUnsigned()).concat([1]):[128].concat(this.ecKey.priv.toByteArrayUnsigned());var checksum=Crypto.SHA256(Crypto.SHA256(bytes,{asBytes:!0}),{asBytes:!0}).slice(0,4);return Base58.encode(bytes.concat(checksum))}}();