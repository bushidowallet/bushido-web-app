{"version":3,"sources":["lib/crypto/jsbn/rng.js"],"names":["rng_seed_int","x","rng_pool","rng_pptr","rng_psize","rng_seed_time","Date","getTime","rng_get_byte","rng_state","prng_newstate","init","length","next","rng_get_bytes","ba","i","SecureRandom","Array","t","navigator","appName","appVersion","window","crypto","z","random","charCodeAt","Math","floor","prototype","nextBytes"],"mappings":"AAYA,QAASA,cAAaC,GACpBC,SAASC,aAAmB,IAAJF,EACxBC,SAASC,aAAgBF,GAAK,EAAK,IACnCC,SAASC,aAAgBF,GAAK,GAAM,IACpCC,SAASC,aAAgBF,GAAK,GAAM,IACjCE,UAAYC,YAAWD,UAAYC,WAIxC,QAASC,iBACPL,cAAa,GAAIM,OAAOC,WAyB1B,QAASC,gBACP,GAAgB,MAAbC,UAAmB,CAIpB,IAHAJ,gBACAI,UAAYC,gBACZD,UAAUE,KAAKT,UACXC,SAAW,EAAGA,SAAWD,SAASU,SAAUT,SAC9CD,SAASC,UAAY,CACvBA,UAAW,EAIb,MAAOM,WAAUI,OAGnB,QAASC,eAAcC,IACrB,GAAIC,EACJ,KAAIA,EAAI,EAAGA,EAAID,GAAGH,SAAUI,EAAGD,GAAGC,GAAKR,eAGzC,QAASS,iBA5DT,GAAIR,WACAP,SACAC,SACAC,SAiBJ,IAAe,MAAZF,SAAkB,CACnBA,SAAW,GAAIgB,OACff,SAAW,CACX,IAAIgB,EACJ,IAAwB,YAArBC,UAAUC,SAAyBD,UAAUE,WAAa,KAAOC,OAAOC,OAAQ,CAEjF,GAAIC,GAAIF,OAAOC,OAAOE,OAAO,GAC7B,KAAIP,EAAI,EAAGA,EAAIM,EAAEb,SAAUO,EACzBjB,SAASC,YAAgC,IAAlBsB,EAAEE,WAAWR,GAExC,KAAiBf,UAAXD,UACJgB,EAAIS,KAAKC,MAAM,MAAQD,KAAKF,UAC5BxB,SAASC,YAAcgB,IAAM,EAC7BjB,SAASC,YAAkB,IAAJgB,CAEzBhB,UAAW,EACXE,gBA0BFY,aAAaa,UAAUC,UAAYjB","file":"lib/crypto/jsbn/rng.min.js","sourcesContent":["// Random number generator - requires a PRNG backend, e.g. prng4.js\r\n\r\n// For best results, put code like\r\n// <body onClick='rng_seed_time();' onKeyPress='rng_seed_time();'>\r\n// in your main HTML document.\r\n\r\nvar rng_state;\r\nvar rng_pool;\r\nvar rng_pptr;\r\nvar rng_psize;\r\n\r\n// Mix in a 32-bit integer into the pool\r\nfunction rng_seed_int(x) {\r\n  rng_pool[rng_pptr++] ^= x & 255;\r\n  rng_pool[rng_pptr++] ^= (x >> 8) & 255;\r\n  rng_pool[rng_pptr++] ^= (x >> 16) & 255;\r\n  rng_pool[rng_pptr++] ^= (x >> 24) & 255;\r\n  if(rng_pptr >= rng_psize) rng_pptr -= rng_psize;\r\n}\r\n\r\n// Mix in the current time (w/milliseconds) into the pool\r\nfunction rng_seed_time() {\r\n  rng_seed_int(new Date().getTime());\r\n}\r\n\r\n// Initialize the pool with junk if needed.\r\nif(rng_pool == null) {\r\n  rng_pool = new Array();\r\n  rng_pptr = 0;\r\n  var t;\r\n  if(navigator.appName == \"Netscape\" && navigator.appVersion < \"5\" && window.crypto) {\r\n    // Extract entropy (256 bits) from NS4 RNG if available\r\n    var z = window.crypto.random(32);\r\n    for(t = 0; t < z.length; ++t)\r\n      rng_pool[rng_pptr++] = z.charCodeAt(t) & 255;\r\n  }  \r\n  while(rng_pptr < rng_psize) {  // extract some randomness from Math.random()\r\n    t = Math.floor(65536 * Math.random());\r\n    rng_pool[rng_pptr++] = t >>> 8;\r\n    rng_pool[rng_pptr++] = t & 255;\r\n  }\r\n  rng_pptr = 0;\r\n  rng_seed_time();\r\n  //rng_seed_int(window.screenX);\r\n  //rng_seed_int(window.screenY);\r\n}\r\n\r\nfunction rng_get_byte() {\r\n  if(rng_state == null) {\r\n    rng_seed_time();\r\n    rng_state = prng_newstate();\r\n    rng_state.init(rng_pool);\r\n    for(rng_pptr = 0; rng_pptr < rng_pool.length; ++rng_pptr)\r\n      rng_pool[rng_pptr] = 0;\r\n    rng_pptr = 0;\r\n    //rng_pool = null;\r\n  }\r\n  // TODO: allow reseeding after first request\r\n  return rng_state.next();\r\n}\r\n\r\nfunction rng_get_bytes(ba) {\r\n  var i;\r\n  for(i = 0; i < ba.length; ++i) ba[i] = rng_get_byte();\r\n}\r\n\r\nfunction SecureRandom() {}\r\n\r\nSecureRandom.prototype.nextBytes = rng_get_bytes;\r\n"],"sourceRoot":"/source/"}